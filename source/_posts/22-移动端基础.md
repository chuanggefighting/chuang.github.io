---
title: 移动端开发基础
tags:
  - 移动端
categories: 移动端
top: false
keywords:
  - 移动端
date: 2019-04-19 02:03:23
description: 开发模式、Viewport 视口、布局方案、适配方案
---

# 一、开发模式

  <div align="center">
    ![Mobile Type](/images/mobile/mobile-type.png) 
  </div> 

## Native App
> 移动端的原生应用

  * 实现：基于手机操作系统 API 并使用原生语言编写
  * 优点
    * 支持离线运行
    * 能够访问智能设备提供的所有功能
    * 更好的运行速度，性能和总体用户体验
    * 支持丰富的图形，动画和更好的渲染效果
  * 缺点
    * 开发成本较高：同一个项目至少需要 Android、iOS、Web 三个开发团队
    * 维护、更新成本高：需要所有用户重新下载安装


## Web App
> 移动端的 Web 浏览器，注意 PC Web 运行在 Windows、Linux 

  * 实现：基于 Html5 实现并运行在 iOS/Android
  * 优点
    * 开发成本较低
    * 适用范围广，跨平台
    * 可以方便、快速地部署
    * 维护成本低：用户可以随时访问最新版本而不需要下载更新
  * 缺点
    * 图形和动画渲染效果差
    * 用户体验差：加载慢、费流量
    * 不能调用系统相关功能：相机、GPS等


## Hybrid App
> 混合 App，兼具 Native App 良好用户交互体验、Web App 跨平台开发的优势

  * 实现：使用原生语言编写应用的外壳，然后在其中内嵌网页语言编写的内容信息
  * 优点
    * 部分支持离线功能
    * 维护、更新较为方便
    * 可调用智能设备相关功能
  * 缺点
    * 用户体验较差
    * 图形和动画渲染效果较差


# 二、基础知识

## 字体
  ```css
  body {
    font-family: -apple-system, BlinkMacSystemFont, "PingFang SC","Helvetica Neue",STHeiti,"Microsoft Yahei",Tahoma,Simsun,sans-serif;
  }
  ```


## 像素
  * 物理像素
    * 单位：dp，获取方法为 window.screen.width/height
    * 特点
      * 屏幕分辨率表示设备屏幕上的物理像素个数
      * 同一个设备上，1dp 代表的物理长度是固定不变的
      * 不同设备之间，1dp 代表的物理长度是可以不同的
  * 逻辑像素
    * 单位：px
    * 特点
      * 改变大小的场景：缩放屏幕、更换设备
      * 它与物理像素之间的比例关系取决于 屏幕特性（是否高清屏）和用户设置的缩放比例，由浏览器自行换算
  * 换算关系
    * dpr：物理像素与CSS像素的比例
    * 关系：1px = (dpr)^2 * dp


## Viewport
  <div style="text-indent: 2em">PC 端网站都是以浏览器窗口(设备屏幕) 作为视口进行布局。但是在移动端，网站的布局视口默认比移动端屏幕宽很多，浏览器为了将页面完整显示出来而会将页面缩小至浏览器窗口中，页面内容看起来被压扁，因此引入了 viewport 视口的概念来解决移动端的页面展示问题。</div>


### layout viewport  
> 布局视口，获取方法为 document.documentElement.clientWidth/clientHeight

  * 默认比移动端屏幕宽很多，而 CSS 页面布局是根据布局视口来计算的
  * 浏览器为了将页面在浏览器窗口中完整地显示出来，会将页面压扁
  * 通过 meta 标签设置 `布局视口宽度 = 浏览器窗口宽度` 之后，页面就会正常显示


### visual viewport
> 视觉视口

  * 用户当前看到的区域，用户可以通过缩放操作视觉视口，同时不会影响布局视口
  * 当放大页面时，用户能看到的页面内容在减少，CSS 像素将跨越更多的物理像素


### ideal viewport
> 理想视口

  * 它的宽度等于移动设备的屏幕宽度，和设备的物理宽度无关
  * 这个理想的宽度是指以 CSS 像素单位计算的，即屏幕的 CSS 像素宽度
  * 布局视口并不是理想视口，所以需要设置：`布局视口 = 理想视口 = 移动设备屏幕`

  
## meta
> 移动设备默认的是 布局视口，但是移动端开发时需要的是 理想视口，meta 标签就用于控制视口

  * viewport 标签只对移动端浏览器有效，对 PC 端浏览器是无效的
  * 当缩放比例为 100% 时，dip 宽度 = CSS 像素宽度 = 理想视口的宽度 = 布局视口的宽度
  * 即使设置了 user-scalable = no，在 Android Chrome 浏览器中也可以强制启用手动缩放
  * 单独设置 initial-scale 或 width 都会有兼容性问题（横竖屏不分），所以设置布局视口为理想视口的最佳方法是同时设置这两个属性
  

  <div align="center">
    ![meta](/images/mobile/meta.png) 
  </div> 
 

## 优化

  * 不滥用 Float：渲染页面时计算量比较大
  * 不滥用 Web 字体：需要下载、解析、重绘当前页面
  * 不声明过多的 Font-size：会影响 CSS 树的效率
  * 减少重绘和回流
    * 减少 drawImage
    * 避免不必要的 DOM 操作
    * 避免使用 document.write
    * 尽量改变 class 而不是 Style
  * 动画优化
    * 尽量使用 CSS3 动画：5 个以内的元素时
    * 适当使用 Canvas 动画：5 个以上元素时
    * 合理使用 requestAnimationFrame 动画代替 setTimeout
  * GPU 加速
    * 注意过渡使用会引发手机过耗电增加
    * 触发 GPU 渲染：transitions、3D transforms、Opacity、Canvas、WebGL、Video


  <div align="center">
    ![meta](/images/mobile/mobile-optimization.png) 
  </div> 



